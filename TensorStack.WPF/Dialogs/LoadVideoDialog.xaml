<controls:DialogControl x:Class="TensorStack.WPF.Dialogs.LoadVideoDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TensorStack.WPF.Dialogs"
        xmlns:controls="clr-namespace:TensorStack.WPF.Controls"
        Title="Load Video" 


        x:Name="UI"
        Icon="{StaticResource ImageIcon}"
        Style="{StaticResource {x:Type controls:DialogControl}}">
    <DockPanel DataContext="{Binding ElementName=UI}" Margin="15, 15, 15, 10" >

        <UniformGrid Columns="2"  DockPanel.Dock="Bottom" >
            <DockPanel Margin="4,15,0,0" Visibility="{Binding IsGenerating, Converter={StaticResource BooleanToHiddenConverter}}">
                <Grid DockPanel.Dock="Left">
                    <controls:FontAwesome Icon="&#xf3f4;" IconStyle="Light" Size="30" IsSpinner="True" />
                </Grid>
                <StackPanel VerticalAlignment="Center" Margin="10,0,0,0">
                    <TextBlock Text="Generating Video Input..." FontSize="14"/>
                    <TextBlock Text="This step may take some time" FontSize="10"/>
                </StackPanel>
            </DockPanel>
            <UniformGrid Columns="2" Margin="0,25,0,0">
                <Button IsDefault="True" Command="{Binding SaveCommand}" MinWidth="100" Height="30">OK</Button>
                <Button IsCancel="True" Command="{Binding CancelCommand}" MinWidth="100" Height="30">Cancel</Button>
            </UniformGrid>
        </UniformGrid>

        <DockPanel>

            <DockPanel  DockPanel.Dock="Right" LastChildFill="False" Margin="15,0,0,0" MinWidth="200" IsEnabled="{Binding IsGenerating, Converter={StaticResource InverseBoolConverter}}">

                <StackPanel DockPanel.Dock="Top">
                    <TextBlock Text="Video Information" />
                    <Separator Opacity=".4"/>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Width: " Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBlock Text="{Binding SourceInfo.Width}" VerticalAlignment="Bottom"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Height: " Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBlock Text="{Binding SourceInfo.Height}" VerticalAlignment="Bottom"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Frames: " Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBlock Text="{Binding SourceInfo.FrameCount}" VerticalAlignment="Bottom"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="FrameRate: " Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBlock Text="{Binding SourceInfo.FrameRate}" VerticalAlignment="Bottom" />
                    </StackPanel>

              

                </StackPanel>



                <UniformGrid Columns="2"  DockPanel.Dock="Bottom" >
                    <StackPanel >
                        <TextBlock Text="ResizeMode" Style="{StaticResource FieldTextBlockStyle}" />
                        <ComboBox ItemsSource="{Binding Source={StaticResource ResizeMode}}" SelectedItem="{Binding SelectedResizeMode}" />
                    </StackPanel>

                    <StackPanel >
                    </StackPanel>

                    <StackPanel IsEnabled="{Binding IsFixedSizeEnabled, Converter={StaticResource InverseBoolConverter}}">
                        <TextBlock Text="Width" Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBox Text="{Binding SelectedWidth, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>

                    <StackPanel IsEnabled="{Binding IsFixedSizeEnabled, Converter={StaticResource InverseBoolConverter}}">
                        <TextBlock Text="Height" Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBox Text="{Binding SelectedHeight, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>

                    <StackPanel >
                        <TextBlock Text="FrameRate" Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBox Text="{Binding SelectedFrameRate, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>

                    <StackPanel>
                        <TextBlock Text="Frames" Style="{StaticResource FieldTextBlockStyle}" />
                        <TextBox Text="{Binding SelectedFrameCount, UpdateSourceTrigger=PropertyChanged}" />
                    </StackPanel>
                </UniformGrid>
            </DockPanel>





            <Border BorderThickness="2" BorderBrush="{StaticResource ContainerBorder}" MinHeight="300" MaxHeight="360" MaxWidth="640">
                <Viewbox >
                    <Grid Width="{Binding CropWidth}" Height="{Binding CropHeight}">
                        <Image Source="{StaticResource ImageTensorstackCubeG}" Visibility="{Binding SourceVideo, Converter={StaticResource InverseNullVisibilityConverter}}" Opacity=".1" Margin="30" />
                        <Viewbox HorizontalAlignment="Center" VerticalAlignment="Center" >
                            <MediaElement x:Name="VideoControl" 
                                Source="{Binding SourceVideo}" 
                                Volume="0"
                                Stretch="Uniform" 
                                LoadedBehavior="Manual" 
                                UnloadedBehavior="Close" 
                                Loaded="VideoControl_Loaded"
                                MediaOpened="VideoControl_MediaOpened"
                                MediaEnded="VideoControl_MediaEnded"
                                MouseLeftButtonDown="VideoControl_MouseDown" />
                            <Viewbox.Style>
                                <Style TargetType="{x:Type Viewbox}">
                                    <Setter Property="Stretch" Value="Fill" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedResizeMode , ElementName=UI}" Value="Crop">
                                            <Setter Property="Stretch" Value="UniformToFill" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Viewbox.Style>
                        </Viewbox>
                    </Grid>
                </Viewbox>
            </Border>
        </DockPanel>

       
    </DockPanel>
</controls:DialogControl>