<CommonControls:BaseControl x:Class="TensorStack.WPF.Controls.AudioElement"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:CommonControls="clr-namespace:TensorStack.WPF.Controls"
             xmlns:CommonConverters="clr-namespace:TensorStack.WPF.Converters"
             x:Name="AudioElementUI" >
    <Border  DataContext="{Binding ElementName=AudioElementUI}" BorderThickness="1" BorderBrush="{StaticResource ComboBoxBorder}" Background="{StaticResource DefaultBackgroundColor}">
        <DockPanel>

            <Grid>
                <MediaElement x:Name="AudioControl"
                    Source="{Binding FileSource, Converter={StaticResource StringToUriConverter}}" 
                    Volume="{Binding Volume}"
                    LoadedBehavior="Manual" 
                    UnloadedBehavior="Close" 
                    ScrubbingEnabled="True" 
                    Loaded="AudioControl_Loaded"
                    MediaOpened="AudioControl_MediaOpened"
                    MediaEnded="AudioControl_MediaEnded"
                    MouseLeftButtonDown="AudioControl_MouseDown" />
                <Image DockPanel.Dock="Left" Source="{StaticResource PlaceholderVideo}" Stretch="Uniform" MinWidth="{Binding ActualHeight}"/>
            </Grid>




            <DockPanel LastChildFill="False">
                <TextBlock Text="{Binding FileSource}" DockPanel.Dock="Top"/>

                <StackPanel DockPanel.Dock="Bottom">

                    <ProgressBar 
                        Height="10"
                        Margin="1"
                        Value="{Binding Progress.Value, Mode=OneWay}"
                        Maximum="{Binding Progress.Maximum, Mode=OneWay}" >
                        <ProgressBar.Style>
                            <Style TargetType="{x:Type ProgressBar}" BasedOn="{StaticResource {x:Type ProgressBar}}">
                                <Setter Property="IsIndeterminate" Value="False"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Progress.Value, ElementName=VideoElementUI}" Value="-1">
                                        <Setter Property="IsIndeterminate" Value="True"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ProgressBar.Style>
                    </ProgressBar>

                    <UniformGrid Columns="4" DockPanel.Dock="Bottom">
                        <Button Command="{Binding LoadCommand}" Visibility="{Binding IsLoadEnabled, Converter={StaticResource BooleanToVisibilityConverter}}" >
                            <CommonControls:FontAwesome Icon="&#xf0ee;" />
                        </Button>
                        <Button Command="{Binding SaveCommand}" Visibility="{Binding IsSaveEnabled, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <CommonControls:FontAwesome Icon="&#xf0c7;" />
                        </Button>
                        <Grid>
                            <Button Command="{Binding PlayCommand}" >
                                <CommonControls:FontAwesome Icon="&#xf04b;" Visibility="{Binding MediaState, Converter={StaticResource InverseEnumToVisibilityConverter}, ConverterParameter=Play}"/>
                            </Button>
                            <Button Command="{Binding PauseCommand}" Visibility="{Binding MediaState, Converter={StaticResource EnumToVisibilityConverter}, ConverterParameter=Play}">
                                <CommonControls:FontAwesome Icon="&#xf04c;" />
                            </Button>
                        </Grid>
                        <Button Command="{Binding StopCommand}">
                            <CommonControls:FontAwesome Icon="&#xf04d;" />
                        </Button>
                    </UniformGrid>

                </StackPanel>
            </DockPanel>
        </DockPanel>
    </Border>
</CommonControls:BaseControl>
